jQuery.fn.jmp3 = function(passedOptions){
    var options = {
        "playerPath": "//cdn.17zuoye.com/static/plugin/jmp3/",
        "playerFile": "singlemp3player_18x18_v3.swf",
        "file": "",
        "width": "18",
        "height": "18",
        "autoStart": "false"
    };
    if (passedOptions) {
        jQuery.extend(options, passedOptions);
    }

    return this.each(function(){
        //IE浏览器无法自动播放被缓存的音频
        var flashVars = 'file=' + options.file + '&autoStart=' + options.autoStart + '&asdfghjkl=' + new Date().getTime();
        var swfUrl = options.playerPath + options.playerFile +'?' + flashVars;

        var mp3html = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ';
        mp3html += 'width="' + options.width + '" height="' + options.height + '" ';
        mp3html += 'codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab">';

        mp3html += '<param name="movie" value="' + swfUrl + '" />';
        mp3html += '<param name="wmode" value="transparent" />';
        mp3html += '<param name="flashvars" value="' + flashVars + '" />';

        mp3html += '<embed wmode="transparent" width="' + options.width + '" height="' + options.height + '" ';
        mp3html += ' src="' + swfUrl + '" ';
        mp3html += ' flashvars="' + flashVars + '" ';
        mp3html += ' type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" />';
        mp3html += '</object>';

        jQuery(this).prepend(mp3html+"&nbsp;");

        // Eolas workaround for IE (Thanks Kurt!)
        if(jQuery.browser.msie){ this.outerHTML = this.outerHTML; }
    });
};